<odoo>
    <data>
        <menuitem
                name="Leave"
                id="hr_holidays.menu_hr_holidays_root"
                sequence="95"
                web_icon="hr_holidays,static/description/icon.png"
                groups="base.group_user"/>

        <menuitem
                id="hr_holidays.menu_hr_holidays_my_leaves"
                name="My Leave"
                parent="hr_holidays.menu_hr_holidays_root"
                sequence="1"/>

        <menuitem
                id="hr_holidays.hr_leave_menu_my"
                name="Leave Request"
                parent="hr_holidays.menu_hr_holidays_my_leaves"
                action="hr_holidays.hr_leave_action_my"
                sequence="2"/>

        <record id="hr_holidays.hr_leave_action_my" model="ir.actions.act_window">
            <field name="name">Leave Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.leave</field>
            <field name="view_mode">tree,form,calendar,kanban,activity</field>
            <field name="context">{}</field>
            <field name="domain">[('user_id', '=', uid)]</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a new leave request
                </p>
                <p>
                    Once a leave request is posted, your manager is notified for validation.
                </p>
            </field>
        </record>

        <menuitem
                id="hr_holidays.menu_open_department_leave_approve"
                name="Leave"
                parent="hr_holidays.menu_hr_holidays_approvals"
                action="hr_holidays.hr_leave_action_action_approve_department"
                sequence="1"/>

        <record id="hr_holidays.hr_leave_action_action_approve_department" model="ir.actions.act_window">
            <field name="name">Leave</field>
            <field name="res_model">hr.leave</field>
            <field name="view_mode">tree,kanban,form,calendar,activity</field>
            <field name="context">{
                'search_default_my_team_leaves':1,
                'search_default_approve':1}
            </field>
            <field name="domain">['|', '|', '&amp;', ('employee_id.leave_manager_id', '=', uid),
                ('holiday_status_id.validation_type', '=', 'manager'), '&amp;', ('holiday_status_id.responsible_id',
                '=', uid), ('holiday_status_id.validation_type', '=', 'hr'), '&amp;', '|',
                ('holiday_status_id.responsible_id', '=', uid), ('holiday_status_id.responsible_id', '=', uid),
                ('holiday_status_id.validation_type', '=', 'both')]
            </field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a new Leave request
                </p>
            </field>
        </record>


        <menuitem
                id="hr_holidays.hr_holidays_status_menu_configuration"
                action="hr_holidays.open_view_holiday_status"
                name="Leave Types"
                parent="hr_holidays.menu_hr_holidays_configuration"
                groups="hr_holidays.group_hr_holidays_user"
                sequence="1"/>

        <record id="hr_holidays.open_view_holiday_status" model="ir.actions.act_window">
            <field name="name">Leave Types</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.leave.type</field>
            <field name="view_mode">tree,kanban,form</field>
        </record>

        <record id="ir_actions_server_approve_allocations" model="ir.actions.server">
            <field name="name">Approve Allocations</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave_allocation"/>
            <field name="binding_model_id" ref="hr_holidays.model_hr_leave_allocation"/>
            <field name="binding_view_types">list</field>
            <field name="state">code</field>
            <field name="code">action = records.action_approve()</field>
        </record>

        <record id="hr_leave_allocation_view_form_dashboard_to_leave" model="ir.ui.view">
            <field name="name">hr.leave.view.form.dashboard</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_form"/>
            <field name="mode">primary</field>
            <field name="priority">100</field>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='holiday_status_id']" position="attributes">
                    <attribute name="string">Leave Type</attribute>
                </xpath>

            </field>


        </record>

        <record id="hr_holidays.hr_leave_allocation_action_my" model="ir.actions.act_window">
            <field name="name">My Allocations</field>
            <field name="res_model">hr.leave.allocation</field>
            <field name="view_mode">tree,kanban,form,activity</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a new leave allocation request
                </p>
                <p>
                    Leave Officers allocate leave days to employees (e.g. paid leave).
                    <br/>
                    Employees request allocations to Leave Officers (e.g. recuperation days).
                </p>
            </field>
            <field name="context">{}</field>
            <field name="domain">[('employee_id.user_id', '=', uid)]</field>
        </record>

        <record id="hr_leave_allocation_view_tree_my_to_leave" model="ir.ui.view">
            <field name="name">hr.leave.view.form.dashboard</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_tree_my"/>
            <field name="mode">primary</field>
            <field name="priority">100</field>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='holiday_status_id']" position="attributes">
                    <attribute name="string">Leave Type</attribute>
                </xpath>
            </field>
        </record>

        <record id="hr_holidays.action_hr_holidays_dashboard" model="ir.actions.act_window">
            <field name="name">All Leave</field>
            <field name="res_model">hr.leave.report.calendar</field>
            <field name="view_mode">calendar</field>
            <field name="domain">[('employee_id.active','=',True)]</field>
            <field name="context">{'hide_employee_name': 1, 'search_default_my_team': 1}</field>
            <field name="search_view_id" ref="hr_holidays.hr_leave_report_calendar_view_search"/>
        </record>


        <record id="hr_holidays.action_hr_available_holidays_report" model="ir.actions.act_window">
            <field name="name">Leave Analysis</field>
            <field name="res_model">hr.leave</field>
            <field name="view_mode">graph,pivot,calendar,form</field>
            <field name="context">{'search_default_year': 1, 'search_default_group_employee': 1,
                'search_default_group_type': 1}
            </field>
        </record>


        <record id="hr_holidays.view_holiday_graph" model="ir.ui.view">
            <field name="name">hr.holidays.report_graph</field>
            <field name="model">hr.leave</field>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <graph string="Leave Summary">
                    <field name="employee_id"/>
                    <field name="number_of_days" type="measure"/>
                </graph>
            </field>
        </record>


        <record id="hr_holidays.act_hr_employee_holiday_request" model="ir.actions.server">
            <field name="name">Leave Analysis</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave_report"/>
            <field name="binding_model_id" ref="hr.model_hr_employee"/>
            <field name="state">code</field>
            <field name="code">
                action = model.action_time_off_analysis()
            </field>
        </record>

        <record id="hr_holidays.hr_leave_action_action_department" model="ir.actions.act_window">
            <field name="name">Leave Analysis</field>
            <field name="res_model">hr.leave</field>
            <field name="view_mode">graph,pivot</field>
            <field name="context">{
                'search_default_department_id': [active_id],
                'default_department_id': active_id}
            </field>
            <field name="domain">[('holiday_type','=','employee')]</field>
        </record>

        <record id="hr_holidays.hr_leave_action_my_request" model="ir.actions.act_window">
            <field name="name">Leave Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.leave</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>



        <record id="work_entry_type_leave_extended_form" model="ir.ui.view">
            <field name="name">work_entry.type.leave.form.extended</field>
            <field name="model">hr.leave.type</field>
            <field name="inherit_id" ref="hr_holidays.edit_holiday_status_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[@id='payroll']" position="after">
                    <group name="notification" string="Notification" colspan="2" groups="base.group_no_one">
                        <group>
                            <field name="leave_notif_subtype_id"
                                   domain="[('res_model','=','hr.leave')]"
                                   context="{'default_name': name, 'default_res_model': 'hr.leave'}"/>
                            <field name="create_calendar_meeting"/>
                            <field name="request_unit" widget="radio"/>
                        </group>
                    </group>
                </xpath>
            </field>
        </record>

    </data>
</odoo>